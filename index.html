<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>น้ำปั่นตลาดโต้รุ่ง</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getFirestore, collection, addDoc, Timestamp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAsDV4gEEQZpJdK9sccKQLMG-vAEc9-KUc",
      authDomain: "nampanorder.firebaseapp.com",
      projectId: "nampanorder",
      storageBucket: "nampanorder.firebasestorage.app",
      messagingSenderId: "123907265628",
      appId: "1:123907265628:web:b52fe97f50d4f97a57c299"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function submitOrder(e) {
      e.preventDefault();

      const name = document.querySelector('input[name="name"]').value;
      const item = document.querySelector('select[name="menu"]').value;
      const sweet = document.querySelector('input[name="sweet"]:checked')?.value || "";
      const topping = document.querySelector('input[name="topping"]:checked')?.value || "";

      if (!name || !item || !sweet) {
        alert("กรุณากรอกข้อมูลให้ครบ");
        return;
      }

      try {
        await addDoc(collection(db, "orders"), {
          name,
          item,
          sweet,
          topping,
          timestamp: Timestamp.now()
        });

        alert("ขอบคุณที่อุดหนุนครับผม!");
        document.querySelector("form").reset();
      } catch (error) {
        alert("เกิดข้อผิดพลาดในการส่งออเดอร์");
        console.error(error);
      }
    }

    window.addEventListener("DOMContentLoaded", () => {
      document.querySelector("form").addEventListener("submit", submitOrder);
    });
  </script>
</head>
<body>
  <h1>น้ำปั่นตลาดโต้รุ่ง</h1>
  <form>
    <label>เลือกเมนู:</label>
    <select name="menu">
      <option>น้ำส้มปั่น</option>
      <option>น้ำแตงโมปั่น</option>
      <option>น้ำมะนาวปั่น</option>
      <option>น้ำสับปะรดปั่น</option>
      <option>น้ำกล้วยปั่น</option>
    </select><br><br>

    <label>ระดับความหวาน:</label><br>
    <input type="radio" name="sweet" value="ไม่หวาน"> ไม่หวาน<br>
    <input type="radio" name="sweet" value="หวานน้อย"> หวานน้อย<br>
    <input type="radio" name="sweet" value="หวานกลาง"> หวานกลาง<br>
    <input type="radio" name="sweet" value="หวานมาก"> หวานมาก<br><br>

    <label>ท้อปปิ้ง:</label>
    <input type="checkbox" name="topping" value="นม"> นม<br><br>

    <label>ชื่อ:</label>
    <input type="text" name="name"><br><br>

    <button type="submit">สั่งน้ำ</button>
  </form>
</body>
</html>
